
<!DOCTYPE html>
<head>
<meta charset="utf-8">

<!--Author: Bestian Tang-->
<!--Version: 1.0-->
<!-- Release to Freemath, 自學數學團-->
<!-- Right: CC0, Public Domain-->

<!--Todo next: add Roman number switch botton -->

</head>

<script type="text/javascript">

	var upBound = 20;
	var lowBound = 0;
	var win = 0;
	var start = 0;
	var objNow;
	var rep = "6";

	function symToC (sym) {
		switch (sym){
			case ' + ': 
				return '加';
			case ' - ':
				return '減';
			case ' × ':
				return '乘以';
			case ' ÷ ':
				return '除以';
			default:
				return '';
		}
	}

	function toC(num) {
		
		var ansC = "";
		num < 0 ? ansC = "負" : ansC = "";
		num < 0 ? num = Math.abs(num) : num = num;
		
		var hunds = Math.floor(num / 100);
		var tens = Math.floor((num - hunds * 100 ) / 10);
		var ones = num - hunds * 100 - 10 * tens;

		var list = ['','','二','三','四','五','六','七','八','九'];
		var list1 = ['','一','二','三','四','五','六','七','八','九'];

		if (num == 0) {
			return '零';
		}

		if (hunds) {
			ansC = ansC + list1[hunds] + '百';
			if (tens) {
				ansC += list1[tens] + '十';
			}
			else {
				if (ones) {
					ansC += '零';
				}
			};
		}		
		else {
			if (tens) {
				ansC += list[tens] + '十';
			}
			else {
			};

		}
		ansC += list1[ones];

		return ansC;
	}

	function symToM (sym) {
		switch (sym){
			case ' + ': 
				return '又有';
			case ' - ':
				return '扣掉';
			case ' × ':
				return '每一塊都變成';
			case ' ÷ ':
				return '分裝成好幾包，每包都要裝';
			default:
				return '';
		}
	}


	function toM (num) {		
		var ansM = "";
		num < 0 ? ansM = "欠" : ansM = "";
		num < 0 ? num = Math.abs(num) : num = num;
		
		var fHunds = Math.floor(num / 500);
		var hunds = Math.floor((num - fHunds * 500) / 100);
		var fiftys = Math.floor((num - fHunds * 500 - hunds * 100) / 50);
		var tens = Math.floor((num - fHunds * 500 - hunds * 100 - fiftys * 50) / 10);
		var fives = Math.floor((num - fHunds * 500 - hunds * 100 - fiftys * 50 - 10 * tens) / 5);
		var ones = num - fHunds * 500 - hunds * 100 - fiftys * 50 - 10 * tens - 5 * fives;

		for (var i = 0; i < hunds; i++) {
			ansM = ansM + "(500)";
		};
		for (var i = 0; i < hunds; i++) {
			ansM = ansM + "(100)";
		};
		for (var i = 0; i < fiftys; i++) {
			ansM = ansM + "(50)";
		};
		for (var i = 0; i < tens; i++) {
			ansM = ansM + "(10)";
		};
		for (var i = 0; i < fives; i++) {
			ansM = ansM + "(5)";
		};
		for (var i = 0; i < ones; i++) {
			ansM = ansM + "(1)";
		};

		return ansM;
	}

	function toR(num) {
		var ansR = "";
		num < 0 ? ansR = "-" : ansR = "";
		num < 0 ? num = Math.abs(num) : num = num;
					
		var fHunds = Math.floor(num / 500);
		var hunds = Math.floor((num - fHunds * 500) / 100);
		var fiftys = Math.floor((num - fHunds * 500 - hunds * 100) / 50);
		var tens = Math.floor((num - fHunds * 500 - hunds * 100 - fiftys * 50) / 10);
		var fives = Math.floor((num - fHunds * 500 - hunds * 100 - fiftys * 50 - 10 * tens) / 5);
		var ones = num - fHunds * 500 - hunds * 100 - fiftys * 50 - 10 * tens - 5 * fives;
		for (var i = 0; i < fHunds; i++) {
			ansR = ansR + "D";
		};
		for (var i = 0; i < hunds; i++) {
			ansR = ansR + "C";
		};
		for (var i = 0; i < fiftys; i++) {
			ansR = ansR + "L";
		};
		for (var i = 0; i < tens; i++) {
			ansR = ansR + "X";
		};
		for (var i = 0; i < fives; i++) {
			ansR = ansR + "V";
		};
		for (var i = 0; i < ones; i++) {
			ansR = ansR + "I";
		};

		return ansR;

	}

	function checkAns (bigAns, data, att){
		var ans = eval(data);
		if (document.getElementById(bigAns).getElementsByTagName("input")[0].value == eval(data)) {
			win++;
			var bonus = "有";
			for (var i = 0; i < Math.floor(win / 3);i++) {
				if (bonus == "有") {
					bonus = "";
				}					
				bonus += "超";
			}
			if (att == "positive") {
				alert("答對了！這是你第"+win+"次連續答對！你"+bonus+["強！", "讚！", "用心！", "認真!"][Math.floor(Math.random()*4)]);
			}
			if (att =="negative") {
				alert("才連續答對"+win+"次…根本就是"+bonus+"靠運氣！");
			}
		}
		else {
			if (att == "positive") {
				alert("答案是"+ans+"。沒關係，再接再勵！在此之前你已連續答對了"+win+"次！");
				win = 0;
			}
			if (att =="negative") {
				alert("答案是"+ans+["才對，你是笨，還是菜，還是呆？","才對，這很簡單，你怎麼都不會？","才對，拜託你小心一點！","才對，不要胡亂回答！"][Math.floor(Math.random()*4)]);
			}
		}
		start = 1;
	}

	function clk (){
		objNow.onclick(objNow);
	}

	function writeBig (qa, data, dataR, dataM, dataC){
		switch (rep) {
			case "VI":
				document.getElementById('bigans').innerHTML = data+"<br /><hr>"+dataR;
				break;

			case "$":
				document.getElementById('bigans').innerHTML = data+"<br /><hr>"+dataM;
				break;

			case "六":
				document.getElementById('bigans').innerHTML = data+"<br /><hr>"+dataC;
				break;

			case "挑戰模式":
				if (qa == "Q") {
					document.getElementById('bigans').innerHTML = data+" = "+"<input type = 'search'></input><button onclick = 'clk()'>送出挑戰!</button>";
						start = 0;
				}
				else {
					checkAns('bigans',data, "positive");
					document.getElementById('bigans').innerHTML = data;
				}
				break;
				
			case "挫折模式":			
				if (qa == "Q") {
					document.getElementById('bigans').innerHTML = data+" = "+"<input type = 'search'></input><button onclick = 'clk()'>忍受挫折!</button>";
						start = 0;
				}
				else {
					checkAns('bigans',data, "negative");
					document.getElementById('bigans').innerHTML = data;
				}
				break;
							
			default:
				document.getElementById('bigans').innerHTML = data;		
		}
	}

	function plch(obj, add, sym) {
		objNow = obj;
		var ans = eval(obj.innerHTML);
		var ansR = toR(ans);
		var ansM = toM(ans); 
		var ansC = toC(ans);
		if (obj.innerHTML !== String(ans) && start !== 1) {
			obj.innerHTML = ans;
			writeBig("A",ans,ansR,ansM,ansC);
		}
		else {
			var n1 = Math.floor(Math.random() * ((upBound - lowBound) / 2 - 1)) + add;
			var n2 = Math.floor(Math.random() * ((upBound - lowBound) / 2 - 1)) + 1;
			n1 = eval(n1 + lowBound / 2);
			n2 = eval(n2 + lowBound / 2);
			var ques = n1+sym+n2;
			var quesR = toR(n1)+sym+toR(n2);
			var quesM = toM(n1)+symToM(sym)+toM(n2);
			var quesC = toC(n1)+symToC(sym)+toC(n2);

			obj.innerHTML = ques;
			writeBig("Q",ques,quesR,quesM,quesC);
			start = 0;
		}
	}

	function pl(obj) {
		plch(obj, 1, ' + ');
	}

	function ch(obj) {
		plch(obj, (upBound - lowBound) / 2, ' - ');
	}

	function tmdv(obj,symR,symE, n1, n2) {
		objNow = obj;

		var ans = eval(obj.innerHTML.split(symR)[0] + symE + obj.innerHTML.split(symR)[1]);
		var ansR = toR(ans);
		var ansC = toC(ans);
		var ansM = toM(ans);

		if (ans && obj.innerHTML !== String(ans) && start !== 1) {
			obj.innerHTML = ans;
			
			writeBig("A",ans,ansR,ansM,ansC);

		}
		else {
			var ques = n1+symR+n2;
			var quesR = toR(n1)+symR+toR(n2);
			var quesC = toC(n1)+symToC(symR)+toC(n2);
			var quesM = toM(n1)+symToM(symR)+toM(n2);

			obj.innerHTML = ques;

			writeBig("Q",ques,quesR,quesM,quesC);

		}
	}

	function tm(obj) {
		
		var n1 = Math.floor(Math.random()*10) + 1;
		var n2 = Math.floor(Math.random()*10) + 1;
		
		tmdv(obj," × "," * ",n1,n2);
	}

	function dv(obj) {
		
		var n2 = Math.floor(Math.random()*10) + 1;
		var n1 = n2 * (Math.floor(Math.random()*10) + 1);
		
		tmdv(obj," ÷ "," / ",n1,n2);
	}

	function swi(obj) {

		var data = obj.innerHTML;

		switch (data)
		{
			case "VI" : 
				rep = "VI";
				alert("已進入羅馬參照模式");
				start = 0;
				break;

			case "$" : 
				rep = "$";
				alert("已進入錢幣參照模式");
				start = 0;
				break;

			case "六" : 
				rep = "六";
				alert("已進入中文參照模式");
				start = 0;
				break;

			case "挑戰模式" : 
				rep = "挑戰模式";
				alert("已進入挑戰模式");
				start = 1;
				break;
				
			case "挫折模式" : 
				rep = "挫折模式";
				alert("已進入挫折模式");
				start = 1;
				break;
			
			default : 
				obj.innerHTML = "6";
				rep = "6";
				start = 0;
				alert("已進入單純阿拉伯數字模式");
		};			
	}
	
	function chUp(obj) {
		upBound = obj.innerHTML;
		alert("加減法上限已設為"+upBound);
	}
	
	function chLow(obj) {
		lowBound = obj.innerHTML;
		alert("加減法下限已設為"+lowBound);
	}
	
</script>

<body>


<h1>閃卡<button onclick="swi(this)">6</button><button onclick="swi(this)">VI</button><button onclick="swi(this)">$</button><button onclick="swi(this)">六</button>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<button onclick="swi(this)">挑戰模式</button>
<button onclick="swi(this)">挫折模式</button>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
<button onclick="chUp(this)">20</button>
<button onclick="chUp(this)">50</button>
<button onclick="chUp(this)">100</button>
<button onclick="chUp(this)">1000</button>
<button onclick="chLow(this)">0</button>
<button onclick="chLow(this)">-20</button>
<button onclick="chLow(this)">-50</button>
<button onclick="chLow(this)">-100</button>
</h1>

<br />
<br />
<br />

<button onclick="pl(this)"> 7 + 8 </button><br /><br />
<button onclick="pl(this)"> 6 + 7 </button><br /><br />
<button onclick="ch(this)"> 12 - 5 </button><br /><br />
<button onclick="ch(this)"> 17 - 9</button><br /><br />
<br />
<div position = "absolute" top = "300px" left = "300px">
	<big><big><big id = "bigans">???
	</big></big></big>
</div>
<br />
<button onclick="tm(this)"> 9 × 7</button><br /><br />
<button onclick="tm(this)"> 6 × 5</button><br /><br />
<button onclick="dv(this)"> 21 ÷ 3</button><br /><br />
<button onclick="dv(this)"> 42 ÷ 6</button><br /><br />



</body>
