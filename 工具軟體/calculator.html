<!DOCTYPE html>
<html ng-app="autoApp">

<head>
<meta charset=utf-8 />
<meta name="viewport" content="width=device-width">

<title>計算機</title>
	<link rel="stylesheet" type="text/css" class="ui" href="../stylesheets/semantic.min.css">
	<link rel="stylesheet" type="text/css" class="ui" href="../stylesheets/jquery-ui.css" />
	<link rel="stylesheet" type="text/css" class="ui" href="../stylesheets/fmDoc.css" />
	<script src="../javascripts/jquery-1.10.2.js"></script>
	<script src="../javascripts/jquery-ui.js"></script>
	<script src="../javascripts/underscore-min.js"></script>
	<script src="../javascripts/backbone-min.js"></script>
	<script src="../javascripts/angular.min.js"></script>


</head>
  
<body>
<title>test</title>

<style type="text/css">

body {
  background: rgba(200,255,255,1);
}
h1, h2, p {
	text-align: center;
}

table {
  margin-left: 10%;
  border: 5px ridge;
  border-collapse: collapse;
  width: 80%;
}

tr, td, th { 
    border: 3px ridge;
}

td, th {
	width: 33%;
	overflow: hidden;
}

td {
	font-size: 1.2rem;
	padding: 5px;
    width: 33%;
	line-height: 1.8rem;
}

td:hover, th:hover {
	background-color: rgba(255,255,200,1);
}


input {
  font-size: 1.2rem;
  background-color: rgba(200,200,255,1);
  border-right: rgba(200,200,255,1);
  border-bottom: rgba(200,200,255,1);
  margin: 3px;
  width: 33%;
}

.wiki {
	width: 1rem;
	height: 1rem;
}

.fm_tool {
	width: 1rem;
	height: 1rem;
}

.small {
	text-align: right;
	font-size: 0.2rem;
}

</style>

</head>

<body>


<div ng-controller="Ctrl">

  <h1>Hello  {{yourName || 'World'}}! ^__^</h1>  

      <h2>打招呼<input type="text" ng-model="yourName" placeholder = "請輸入您的名字">  </input></h2>

      <br/>

      <table>

      <tr>
        <th><input type="number" ng-model = "s1"></input></th>
        <th><input type="number" ng-model = "s2"></input></th>
        <th ng-click = "s1 = Math.floor(Math.random()*20);s2 = Math.floor(Math.random()*20)" />
      </tr>

      <tr><td/><td/><td/></tr>

      <tr><td> {{ s1 }} 的因數有 {{ s1 | fact }} <br/>
      	  	<a href = "../weblearn/因數與倍數.htm">因數與倍數<img class = "fm_tool" /></a></td>
          <td> {{ s2 }} 的因數有 {{ s2 | fact }} <br/>
          	<a href = "../weblearn/因數與倍數.htm">因數與倍數<img class = "fm_tool" /></a></td>
          <td>{{s1 | arith}} + {{s2 | arith}} = {{ s1 + s2 | arith}} <br/>
          	<a href = "單機閃卡.html">閃卡<img class = "fm_tool" /></a></td>
      </tr>


      <tr><td> {{ s1 }} 的倍數有<br/> {{ s1 | mul }} <br/>
      		<a href = "../weblearn/因數與倍數.htm">因數與倍數<img class = "fm_tool" /></a></td>
          <td> {{ s2 }} 的倍數有<br/> {{ s2 | mul }} <br/>
          	<a href = "../weblearn/因數與倍數.htm">因數與倍數<img class = "fm_tool" /></a></td>
          <td>{{s1 | arith}} - {{s2 | arith}} = {{ s1 - s2 | arith}} <br/>
          	<a href = "單機閃卡.html">閃卡<img class = "fm_tool" /></a></td>
      </tr>
      
      <tr>
	      	<td>{{ s1 }}, {{ s2 }} 的最大公因數： {{ {a:s1, b:s2} | gcd }} <br />
	      		<a href = "../weblearn/因數與倍數.htm">因數與倍數<img class = "fm_tool" /></a>
      		</td>
      		<td>
      		 	{{ s1 }}, {{ s2 }} 的最小公倍數： {{ {a:s1, b:s2} | lcm }} <br />
      			<a href = "../weblearn/因數與倍數.htm">因數與倍數<img class = "fm_tool" />	</a>
	      	</td>
          	<td>{{s1 | arith}} × {{s2 | arith}} = {{ s1 * s2 | arith}} <br/>
          		<a href = "單機閃卡.html">閃卡<img class = "fm_tool" /></a>
          	</td>
      </tr>
      
      <tr>
	      <td> {{ s1 }}的階乘<br/> = {{ s1 }}! = {{ s1 | factorialM }} = {{ s1 | factorial }} <br/>
	          	<a href = "http://zh.wikipedia.org/wiki/階乘">階乘<img class = "wiki" /> </a></td>
	      <td> {{ s2 }}的階乘<br/> = {{ s2 }}! = {{ s2 | factorialM }} = {{ s2 | factorial }} <br/>
		         <a href = "http://zh.wikipedia.org/wiki/階乘">階乘<img class = "wiki" /> </a></td>
	      <td>{{s1 | arith}} ÷ {{s2 | arith}} = {{ {a:s1, b:s2} | divR}} <br/>
      			<a href = "單機閃卡.html">閃卡<img class = "fm_tool" /></a></td>
      </tr>

      <tr>
     	<td> P <sup>{{ s1 }}</sup> <sub>{{ s2 }} </sub> = {{ {a:s1, b:s2} | perm }} <br />
      	<a href = "http://zh.wikipedia.org/wiki/组合数学#.E6.8E.92.E5.88.97">排列<img class = "wiki" /></a>
      	</td>
      	<td> C <sup>{{ s1 }}</sup> <sub>{{ s2 }} </sub> = {{ {a:s1, b:s2} | comb }} <br/>
      	<a href = "http://zh.wikipedia.org/wiki/组合数学#.E7.BB.84.E5.90.88">組合<img class = "wiki" /> </a> </td>

      <td>{{s1 | arith}} / {{s2 | arith}} = {{ {a:s1, b:s2} | div}} <br/> <a href = "../weblearn/分數.htm">分數<img class = "fm_tool" /></a></td>
      </tr>
      
      <tr>

      	<td>{{s1 | arith}} <sup> {{s2 | arith}} </sup> = {{ {a:s1, t:s2} | powM }} = {{ {a:s1, t:s2} | pow }} <br/>

      	<a href = "../weblearn/指數與科學記號.htm">指數與科學記號<img class = "fm_tool" /></a></td>

      	<td>{{s2 | arith}} <sup> {{s1 | arith}} </sup> = {{ {a:s2, t:s1} | powM }} = {{ {a:s2, t:s1} | pow }} <br />
      	<a href = "../weblearn/指數與科學記號.htm">指數與科學記號<img class = "fm_tool" /></a> </td>

      	<td>log <sub>{{ s1 }}</sub> {{ s2 }} = {{ {a:s1, b:s2} | log }} <br/>
	  	<a href = "../weblearn/指數與對數.htm">指數與對數<img class = "fm_tool" /></a> <a href = "http://zh.wikipedia.org/wiki/對數">對數<img class = "wiki" /> </a></td>

      </tr>

	  <tr><td /><td /><td /></tr>

      </table>

</div>



<script type="text/javascript">



$(document).ready(function(){

		$("input").eq(0).focus();

		$(".wiki").attr("src", "http://www.zengardner.com/wp-content/uploads/500px-wikipedia-logo-v2.png");

		$(".fm_tool").attr("src", "../images/math-logo.png");

	//	$("td").toggleClass("small");

		$("td").click(function(){
			if ($(this).html()) {
				$(this).toggleClass("focus");
				$("td").addClass("small");
				$("td.focus").removeClass("small");
			} else {
				if ( $("td.focus").length ) {$("td").addClass("small")}; 
				$("td").removeClass("focus");
				$("td").toggleClass("small");
			}
		});


		$("a").attr("target", "_blank").css("float", "right");

	});


var autoApp = angular.module('autoApp', ['autoFilters']);

function Ctrl($scope) {
	$scope.numbers = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17];
	$scope.numbers0 = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17];
	$scope.s1 = Math.floor(Math.random() * 20);
	$scope.s2 = Math.floor(Math.random() * 20);

	$scope.Math = window.Math;
}

function fact(input) {
	var ans = 1;
        for (var i = 1; i <= input; i++) {
        	ans *= i;
    };
    return ans;
}

function isInt(input) {
	return (input == Math.floor(input));
}

angular.module('autoFilters', []).filter('arith', function() {
    return function(input) {
      return input ? input : 0;
    };
  }).filter(('div'), function(){
    return function(input){
		var ans = 0;
		var s1 = input.a;
		var s2 = input.b;
		while ((Math.abs(s1) >= Math.abs(s2)) && s2) {
		 if (s1 > 0 ) {
		    s1 -= Math.abs(s2);
		    ans += s2 / Math.abs(s2);
		 }
		 else if (s1 < 0 ) {
		    s1 += Math.abs(s2);
		    ans -= s2 / Math.abs(s2);
		 }         
		}
		if (s2 == 0) {
		if (s1 > 0) return Infinity;
		if (s1 < 0) return Infinity;
		if (s1 == 0) return NaN;
		}
		else {
		if (!ans) ans = '';
		return s1 ? ans + ' ' + s1 + '/' + s2 : ans;
		}
  	};
}).filter(('divR'), function(){    
    return function(input){
		var ans = 0;
		var s1 = input.a;
		var s2 = input.b;
		while (((Math.abs(s1) >= Math.abs(s2)) || s1 < 0) && s2 ) {
			 if (s1 > 0 ) {
			    s1 -= Math.abs(s2);
			    ans += s2 / Math.abs(s2);
			 }
			 else if (s1 < 0 ) {
			    s1 += Math.abs(s2);
			    ans -= s2 / Math.abs(s2);
			 }         
		}
		if (s2 == 0) {
		if (s1 > 0) return Infinity;
		if (s1 < 0) return Infinity;
		if (s1 == 0) return NaN;
		}
		else {
		if (!ans) ans = '';
		return s1 ? ans + ' ...... ' + s1 : ans;
		}
  	};
}).filter(('pow'), function(){
    return function(input){
       return Math.pow(input.a, input.t);
  	};
}).filter(('powM'), function(){
	return function(input){
		var list = []; var ans;
		for (var i = 0; i < Math.abs(input.t); i++) {
			list.push(input.a);
	    };
	    ans = list.length < 10 ? list.join(' × ') : list.length + '個' + input.a + '相乘';

	    if (!isInt(input.t)) return (input.a + '的' + input.t + '次方');
	    if (input.t == 0) return input.a + ' ÷ ' + input.a; 
		return (input.t < 0) ? '1 / (' + ans + ')' : ans;
	};
}).filter(('fact'), function(){
     return function(input){
        var n = Math.abs(input);
        var facts = [];
        for (var i = 1; i <= n; i++) {
          if (!(n % i)) facts.push(i);        

        };
        return facts.join();
  };
}).filter(('mul'), function(){
     return function(input){
        var muls = [];
        for (var i = -1; i <= 4; i++) {
           muls.push(i * input);        
        };
        return '..., '+muls.join(', ')+', ...';
  };
}).filter(('gcd'), function(){
     return function(input){

        a = Math.abs(input.a);
        b = Math.abs(input.b);
        
        while (b * a) {          
          a > b ? a = a % b : b = b % a;
        }

        return (Math.max(a,b) == 1) ? "1(互質)" :  Math.max(a,b);

  };
}).filter(('lcm'), function(){
     return function(input){

        a = Math.abs(input.a);
        b = Math.abs(input.b);
        
        while (b * a) {          
          a > b ? a = a % b : b = b % a;
        }

        return input.a * input.b / Math.max(a,b);

  };
}).filter(('factorial'), function(){
     return function(input){
        if (!isInt(input)) return NaN;
        return input >= 0 ? fact(input) : NaN;
  };
}).filter(('factorialM'), function(){
     return function(input){

     	var ans = 1;
        for (var i = 2; i <= input; i++) {
        	ans += ' × '+i;
        };

        if (ans.length > 20) ans = '1 × ... × ' + input; 
        if (!isInt(input)) return input+'的階乘';
        return input >= 0 ? ans : '';

  };
}).filter(('perm'), function(){
     return function(input){
     	return input.a >= input.b && input.b >= 0 ? fact(input.a) / fact(input.a - input.b) : NaN;
  };
}).filter(('comb'), function(){
     return function(input){
     	return input.a >= input.b && input.b >= 0 ? fact(input.a) / fact(input.a - input.b) / fact(input.b) : NaN;
  };
}).filter(('log'), function(){
     return function(input){
     	return Math.log(input.b) / Math.log(input.a);
  };
});



</script>


</body>




<script type="text/javascript">

		var primesBelowSqrt = function(n) {
			var primes = [2];
			for (var i = 2; i < Math.sqrt(n); i++) {
				var good = 1;
			 	for (var j = 0; j < primes.length; j++) {
			 		if (i % primes[j] == 0) good = 0;
			 	};
			 	if (good == 1) primes.push(i);
			};
		}

		var primeFactorize = function(n) {
			var ans = [];
			var primes = primesBelowSqrt(n);
			while(n > 1) {
				for (var i = 0; i < primes.length; i++) {
					if (n % primes[i] == 0) {
						n = n / primes[i];
						ans[primes[i]] += 1;
					}
				};
			}
			return ans;
		}

		var maxs = function(list) {
			var ans = list[0];
			for (var i = 0; i < list.length; i++) {
				ans = Math.max(ans, list[i])
			};
			return ans;
		}

		var fromPrimeFact = function(list){
			var ans = 1;
			for (var i = 0; i < list.length; i++) {
				if (i > 0) ans *= Math.pow(i, list[i]);
			};
			return ans;
		}

		var lcm = function(list){
			var ans = [];
			var factList = [];
			var factLengList = [];
			for (var i = 0; i < list.length; i++) {
				factList[i] = primeFactorize(list[i]);
				factLengList[i] = primeFactorize(list[i]).length;
			};

			var maxLeng = maxs(factLengList);

			for (var i = 0; i < maxLeng.length; i++) {
				var exponent = 0;
				var expList = [];
				for (var j = 0; j < factList.length; j++) {
					expList.psuh(factList[j]);
				};
				exponent = maxs(expList);
				ans[i] = exponent;
			};

			return fromPrimeFact(ans);

		}

		var gcds = function(list) {
			var ans = list[0];

				var gcd = function(a, b) {
				    if ( ! b) {
				        return a;
				    }

				    return gcd(b, a % b);
				};

			for (var i = 0; i < list.length; i++) {
				ans = gcd(ans,list[i])
			};
			return ans;
		};


	
</script>
